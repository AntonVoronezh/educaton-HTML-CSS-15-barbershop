const getForm = document.querySelector('.form');
const getSubmitForm = document.querySelector('.btn--form');
const getBeardList = document.querySelector('.beard__list');
const getAllBeardItems = getBeardList.querySelectorAll('.radio');
const getDopList = document.querySelector('.dop');
const getAllDopItems = getDopList.querySelectorAll('.checkbox');


getSubmitForm.addEventListener('click', createOffer);

function createOffer(event) {
    event.preventDefault();

    const arrDop = [];
    [...getAllDopItems].filter(elem => elem.checked === true ? arrDop.push(elem.nextElementSibling.nextElementSibling.innerHTML) : null);
    const strDop = arrDop.join(', ');

    let BeardItem = '';
    [...getAllBeardItems].filter(elem => elem.checked === true ? BeardItem = elem.nextElementSibling.nextElementSibling.innerHTML : null);

    const text =
        `Ваше имя - <b>${getForm.name.value}</b>, <br>
    ваше отчество - <b>${getForm.surname.value}</b>,<br>
    ваша фамилия <b>"${getForm.family.value}"</b> <br>
    ваш телефон <b>"${getForm.phone.value}"</b> <br>
    ваш майл <b>"${getForm.mail.value}"</b> <br>
    <strong>будут сохранены и опубликованы</strong><br><br>
    ваша Информация для мастера <b>"${getForm.text.value}"</b> <br>
    <strong>будут передана мастеру</strong><br><br>
    модель бороды "${BeardItem}" <br>
    + <br>
    ${strDop} <br>
    `;
    // console.log(text);

    const successOverlay2 = createOverlay(text);
    document.body.appendChild(successOverlay2);

};
// // начало карты
ymaps.ready(function () {
    var myMap = new ymaps.Map('map', {
        center: [51.680427, 39.176769],
        zoom: 14
    }, {
            searchControlProvider: 'yandex#search'
        }),

        // Создаём макет содержимого.
        MyIconContentLayout = ymaps.templateLayoutFactory.createClass(
            '<div style="color: #FFFFFF; font-weight: bold;">$[properties.iconContent]</div>'
        ),
      
        myPlacemark = new ymaps.Placemark(myMap.getCenter(), {
            hintContent: 'Собственный значок метки',
            balloonContent: 'Это красивая метка'
        }, {
                // Опции.
                // Необходимо указать данный тип макета.
                iconLayout: 'default#image',
                // Своё изображение иконки метки.
                iconImageHref: './img/logo/logotype-map.svg',
                // Размеры метки.
                iconImageSize: [226, 30],
                // Смещение левого верхнего угла иконки относительно
                // её "ножки" (точки привязки).
                iconImageOffset: [-1, -1]
            });

       

    myMap.geoObjects
        .add(myPlacemark)
});
// конец карты

const getMobMenu = document.querySelector('.mob-menu');
const getOpenMobMenu = document.querySelector('.mobile-menu');
const getUserLink = document.querySelectorAll('.user__link');

getMobMenu.addEventListener('click', closeMobMenu);

function closeMobMenu() {
  getMobMenu.classList.add('mob-menu-hide')
};

getOpenMobMenu.addEventListener('click', openMobMenu);

function openMobMenu() {
  getMobMenu.classList.remove('mob-menu-hide')
};



var link = document.querySelectorAll(".user__link");

var popup = document.querySelector(".modal-login");
var close = popup.querySelector(".modal-close");

var form = popup.querySelector("form");
var login = popup.querySelector("[name=login]");
var password = popup.querySelector("[name=password]");

var storage = localStorage.getItem("login");

link[0].addEventListener("click", functionClick);
link[1].addEventListener("click", functionClick);

function functionClick (evt) {

  evt.preventDefault();
  popup.classList.add("modal-show");

  if (storage) {
    login.value = storage;
    password.focus();
  } else {
    login.focus();
  }
};

close.addEventListener("click", function (evt) {
  evt.preventDefault();
  popup.classList.remove("modal-show");
  popup.classList.remove("modal-error");
});

form.addEventListener("submit", function (evt) {
  evt.preventDefault();
  if (!login.value || !password.value) {
    evt.preventDefault();
    popup.classList.remove("modal-error");
    popup.offsetWidth = popup.offsetWidth;
    popup.classList.add("modal-error");
  } else {
    localStorage.setItem("login", login.value);
  }
  console.log(login.value, password.value);

  const successOverlay3 = createOverlay(`Вот тут ваши данные (${login.value}:${password.value}) будут куда-то отправлены`);
  document.body.appendChild(successOverlay3);
  
});

window.addEventListener("keydown", function (evt) {
  if (evt.keyCode === 27) {
    if (popup.classList.contains("modal-show")) {
      popup.classList.remove("modal-show");
      popup.classList.remove("modal-error");
    }
  }
});


const getNewsShowBtn = document.querySelector('.news-show');
const getHideNewsLists = document.querySelectorAll('.news__list--bottom');
// const getShowNewsLists = document.querySelectorAll('.news__list--show');

getNewsShowBtn.addEventListener('click', funcNewsShow);

function funcNewsShow() {
    getHideNewsLists.forEach(elem => {
        elem.classList.toggle('news__list--show')
    });
    getNewsShowBtn.innerHTML = 'спрятать';
    getNewsShowBtn.removeEventListener('click', funcNewsShow);
    getNewsShowBtn.addEventListener('click', funcNewsHide);
};

function funcNewsHide() {
   
    getHideNewsLists.forEach(elem => {
        elem.classList.toggle('news__list--show')
    });
    
    getNewsShowBtn.innerHTML = 'показать все';
    getNewsShowBtn.removeEventListener('click', funcNewsHide);
    getNewsShowBtn.addEventListener('click', funcNewsShow);
};

// начало кода модальное окно отзывов
let text = '<br><br><strong>СЕКРЕТЫ МЯГКОЙ И ПОСЛУШНОЙ БОРОДЫ</strong> \
<br><br>1. ГОРЯЧИЙ ДУШ. ПОВЫШЕННАЯ ВЛАЖНОСТЬ И ПАР, РАСПАРЯТ КОЛЮЧИЕ ВОЛОСКИ ВАШЕЙ БОРОДЫ. ПОСЛЕ ДУША, ВОСПОЛЬЗУЙТЕСЬ УВЛАЖНЯЮЩИМ МАСЛОМ (ЛЮБЫМ, КОТОРОЕ У ВАС ЕСТЬ ИЛИ СПЕЦИАЛЬНЫМ ДЛЯ БОРОДЫ), НАКРОЙТЕ ЛИЦО МАХРОВЫМ ПОЛОТЕНЦЕМ НА 10-15 МИНУТ И СДЕЛАЙТЕ ЛЕГКИЙ МАССАЖ.\
<br><br>2. НЕ МОЙТЕ БОРОДУ КАЖДЫЙ ДЕНЬ!!!ОТ ЕЖЕДНЕВНОГО МЫТЬЯ,ВОЛОСЫ НА БОРОДЕ СТАНОВЯТСЯ ЕЩЕ ЖЕСТЧЕ. МОЖНО МЫТЬ ЧЕРЕЗ ДЕНЬ,ЕСЛИ ЭТО КРАЙНЕ НЕОБХОДИМО, ТОГДА ПРИРОДНЫЕ МАСЛА,КОТОРЫЕ ДЕЛАЮТ ВОЛОСЫ ПОСЛУШНЫМИ УСПЕЮТ НАКОПИТЬСЯ.\
<br><br>3. КОНДИЦИОНЕР ДЛЯ ВОЛОС ИЛИ СПЕЦИАЛЬНЫЙ КОНДИЦИОНЕР ДЛЯ БОРОДЫ. ДАННОЕ СРЕДСТВО ПОМОЖЕТ УПРАВЛЯТЬ ВОЛОСАМИ И СДЕЛАТЬ ИХ МАКСИМАЛЬНО ПОДАТЛИВЫМИ.';

const getCommentsSelectors = document.querySelectorAll(".news__more-link");
const successOverlay = createOverlay(" <img src=\"./img/news/news1.jpg\">" + text);
// console.log(getCommentsSelectors.length);


for (let i = 0; i < getCommentsSelectors.length; i += 1) {
    getCommentsSelectors[i].addEventListener("click", function (event) {
        event.preventDefault();
        document.body.appendChild(successOverlay);
    });
}

function createOverlay(content) {
    const overlayElement = document.createElement("div");
    overlayElement.classList.add("overlay");
  
    const template = document.querySelector("#overlayTemplate");
    overlayElement.innerHTML = template.innerHTML;
  
    const closeElement = overlayElement.querySelector(".close");
    closeElement.addEventListener("click", function(event) {
        event.preventDefault();
      document.body.removeChild(overlayElement);
    });
  
    const contentElement = overlayElement.querySelector(".content");
    contentElement.innerHTML = content;
  
    return overlayElement;
  }


const getSliderBtnSubmit = document.querySelector('.slider--submit');
const getSliderSubmitForm = document.querySelector('.slider-form');
const getSliderSubmitBtn = document.querySelector('.slider-form__submit');
const getSliderP = document.querySelector('.slider-form__out');

getSliderBtnSubmit.addEventListener('click', createSubmitForm);

function createSubmitForm() {
    getSliderSubmitForm.style.height = '100%';
    getSliderSubmitForm.style.opacity = '1';
};

getSliderSubmitBtn.addEventListener('click', createNewComment);


const left = document.querySelector(".slider__left");
const right = document.querySelector(".slider__right");
const items = document.querySelector("#items");
const sliderDotsAll = document.querySelectorAll('.slider__dots-item');
const sliderDotsDiv = document.querySelector('.slider__dots');
const item = items.querySelectorAll(".elem");

const width = 100;
let count = 0;

right.addEventListener("click", function () {

    if (count <= item.length - 2) {
        count += 1;

        makePosition(count);

        sliderDotsAll.forEach(elem => elem.classList.remove('slider__dots-item--active'));
        sliderDotsAll[count].classList.add('slider__dots-item--active');
    }
});

left.addEventListener("click", function () {

     if (count !== 0) {
        count -= 1;

        makePosition(count);

        sliderDotsAll.forEach(elem => elem.classList.remove('slider__dots-item--active'));
        sliderDotsAll[count].classList.add('slider__dots-item--active');
    }
});

sliderDotsDiv.addEventListener('click', changeActiveDots);

function changeActiveDots(event) {

    sliderDotsAll.forEach(elem => elem.classList.remove('slider__dots-item--active'));
    


    event.target.classList.add('slider__dots-item--active');

    sliderDotsAll.forEach((elem, num) => {
        if(elem.classList.contains('slider__dots-item--active'))
        makePosition(num);
    } );

};

function makePosition(argCount) {
    position = width * argCount;
    return items.style.marginLeft = '-' + position + '%';
};

let player;

function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
        // height: '360',
        // width: '640',
        videoId: '2e0nEgLAro4',
        playerVars: {
            enablejsapi: 1,
            controls: 0,
            disablekb: 0,
            showinfo: 0,
            rel: 0,
            autoplay: 0,
            modestbranding: 1
        },
        events: {
            // 'onReady': onPlayerReady,
            // 'onStateChange': onPlayerStateChange
        }
    });
}

const getVideo = document.querySelector(".player__video");
const getVideoPlayPauseButton = document.querySelector(".video__play-pause");
const getcVideoIcon = document.querySelector(".control__video-icon");
const getTimeRange = document.querySelector(".control__time-range");
const getAudioPlayPauseButton = document.querySelector(".control__sound-icon");
const getSoundRange = document.querySelector(".control__sound-range");


getVideoPlayPauseButton.addEventListener('click', playPause);
getcVideoIcon.addEventListener('click', playPause);
getVideo.addEventListener('timeupdate', percentRange);
getTimeRange.addEventListener('input', progressRange);

getAudioPlayPauseButton.addEventListener('click', playAudio);
getSoundRange.addEventListener('input', percentSound);
function getCurrentTime() {
    var currentTime = player.getCurrentTime();
    return roundNumber(currentTime, 3);
  }
console.log(player.getPlayerState());

function playPause() {

    if (player.getPlayerState() !== 1) {
        player.playVideo();
        getVideoPlayPauseButton.style.opacity = '0';
    } else {
        player.pauseVideo();
        getVideoPlayPauseButton.style.opacity = '0.5';
    }
};




//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvcm0uanMiLCJtYXAuanMiLCJtb2ItbWVudS5qcyIsIm1vZGFsLmpzIiwibmV3cy5qcyIsInNsaWRlci1zdWJtaXQuanMiLCJzbGlkZXIuanMiLCJ2aWRlby5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3REQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGdldEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybScpO1xyXG5jb25zdCBnZXRTdWJtaXRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ0bi0tZm9ybScpO1xyXG5jb25zdCBnZXRCZWFyZExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmVhcmRfX2xpc3QnKTtcclxuY29uc3QgZ2V0QWxsQmVhcmRJdGVtcyA9IGdldEJlYXJkTGlzdC5xdWVyeVNlbGVjdG9yQWxsKCcucmFkaW8nKTtcclxuY29uc3QgZ2V0RG9wTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kb3AnKTtcclxuY29uc3QgZ2V0QWxsRG9wSXRlbXMgPSBnZXREb3BMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGVja2JveCcpO1xyXG5cclxuXHJcbmdldFN1Ym1pdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjcmVhdGVPZmZlcik7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVPZmZlcihldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCBhcnJEb3AgPSBbXTtcclxuICAgIFsuLi5nZXRBbGxEb3BJdGVtc10uZmlsdGVyKGVsZW0gPT4gZWxlbS5jaGVja2VkID09PSB0cnVlID8gYXJyRG9wLnB1c2goZWxlbS5uZXh0RWxlbWVudFNpYmxpbmcubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVySFRNTCkgOiBudWxsKTtcclxuICAgIGNvbnN0IHN0ckRvcCA9IGFyckRvcC5qb2luKCcsICcpO1xyXG5cclxuICAgIGxldCBCZWFyZEl0ZW0gPSAnJztcclxuICAgIFsuLi5nZXRBbGxCZWFyZEl0ZW1zXS5maWx0ZXIoZWxlbSA9PiBlbGVtLmNoZWNrZWQgPT09IHRydWUgPyBCZWFyZEl0ZW0gPSBlbGVtLm5leHRFbGVtZW50U2libGluZy5uZXh0RWxlbWVudFNpYmxpbmcuaW5uZXJIVE1MIDogbnVsbCk7XHJcblxyXG4gICAgY29uc3QgdGV4dCA9XHJcbiAgICAgICAgYNCS0LDRiNC1INC40LzRjyAtIDxiPiR7Z2V0Rm9ybS5uYW1lLnZhbHVlfTwvYj4sIDxicj5cclxuICAgINCy0LDRiNC1INC+0YLRh9C10YHRgtCy0L4gLSA8Yj4ke2dldEZvcm0uc3VybmFtZS52YWx1ZX08L2I+LDxicj5cclxuICAgINCy0LDRiNCwINGE0LDQvNC40LvQuNGPIDxiPlwiJHtnZXRGb3JtLmZhbWlseS52YWx1ZX1cIjwvYj4gPGJyPlxyXG4gICAg0LLQsNGIINGC0LXQu9C10YTQvtC9IDxiPlwiJHtnZXRGb3JtLnBob25lLnZhbHVlfVwiPC9iPiA8YnI+XHJcbiAgICDQstCw0Ygg0LzQsNC50LsgPGI+XCIke2dldEZvcm0ubWFpbC52YWx1ZX1cIjwvYj4gPGJyPlxyXG4gICAgPHN0cm9uZz7QsdGD0LTRg9GCINGB0L7RhdGA0LDQvdC10L3RiyDQuCDQvtC/0YPQsdC70LjQutC+0LLQsNC90Ys8L3N0cm9uZz48YnI+PGJyPlxyXG4gICAg0LLQsNGI0LAg0JjQvdGE0L7RgNC80LDRhtC40Y8g0LTQu9GPINC80LDRgdGC0LXRgNCwIDxiPlwiJHtnZXRGb3JtLnRleHQudmFsdWV9XCI8L2I+IDxicj5cclxuICAgIDxzdHJvbmc+0LHRg9C00YPRgiDQv9C10YDQtdC00LDQvdCwINC80LDRgdGC0LXRgNGDPC9zdHJvbmc+PGJyPjxicj5cclxuICAgINC80L7QtNC10LvRjCDQsdC+0YDQvtC00YsgXCIke0JlYXJkSXRlbX1cIiA8YnI+XHJcbiAgICArIDxicj5cclxuICAgICR7c3RyRG9wfSA8YnI+XHJcbiAgICBgO1xyXG4gICAgLy8gY29uc29sZS5sb2codGV4dCk7XHJcblxyXG4gICAgY29uc3Qgc3VjY2Vzc092ZXJsYXkyID0gY3JlYXRlT3ZlcmxheSh0ZXh0KTtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc3VjY2Vzc092ZXJsYXkyKTtcclxuXHJcbn07IiwiLy8gLy8g0L3QsNGH0LDQu9C+INC60LDRgNGC0YtcclxueW1hcHMucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG15TWFwID0gbmV3IHltYXBzLk1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogWzUxLjY4MDQyNywgMzkuMTc2NzY5XSxcclxuICAgICAgICB6b29tOiAxNFxyXG4gICAgfSwge1xyXG4gICAgICAgICAgICBzZWFyY2hDb250cm9sUHJvdmlkZXI6ICd5YW5kZXgjc2VhcmNoJ1xyXG4gICAgICAgIH0pLFxyXG5cclxuICAgICAgICAvLyDQodC+0LfQtNCw0ZHQvCDQvNCw0LrQtdGCINGB0L7QtNC10YDQttC40LzQvtCz0L4uXHJcbiAgICAgICAgTXlJY29uQ29udGVudExheW91dCA9IHltYXBzLnRlbXBsYXRlTGF5b3V0RmFjdG9yeS5jcmVhdGVDbGFzcyhcclxuICAgICAgICAgICAgJzxkaXYgc3R5bGU9XCJjb2xvcjogI0ZGRkZGRjsgZm9udC13ZWlnaHQ6IGJvbGQ7XCI+JFtwcm9wZXJ0aWVzLmljb25Db250ZW50XTwvZGl2PidcclxuICAgICAgICApLFxyXG4gICAgICBcclxuICAgICAgICBteVBsYWNlbWFyayA9IG5ldyB5bWFwcy5QbGFjZW1hcmsobXlNYXAuZ2V0Q2VudGVyKCksIHtcclxuICAgICAgICAgICAgaGludENvbnRlbnQ6ICfQodC+0LHRgdGC0LLQtdC90L3Ri9C5INC30L3QsNGH0L7QuiDQvNC10YLQutC4JyxcclxuICAgICAgICAgICAgYmFsbG9vbkNvbnRlbnQ6ICfQrdGC0L4g0LrRgNCw0YHQuNCy0LDRjyDQvNC10YLQutCwJ1xyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgIC8vINCe0L/RhtC40LguXHJcbiAgICAgICAgICAgICAgICAvLyDQndC10L7QsdGF0L7QtNC40LzQviDRg9C60LDQt9Cw0YLRjCDQtNCw0L3QvdGL0Lkg0YLQuNC/INC80LDQutC10YLQsC5cclxuICAgICAgICAgICAgICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgICAgICAgICAgICAgIC8vINCh0LLQvtGRINC40LfQvtCx0YDQsNC20LXQvdC40LUg0LjQutC+0L3QutC4INC80LXRgtC60LguXHJcbiAgICAgICAgICAgICAgICBpY29uSW1hZ2VIcmVmOiAnLi9pbWcvbG9nby9sb2dvdHlwZS1tYXAuc3ZnJyxcclxuICAgICAgICAgICAgICAgIC8vINCg0LDQt9C80LXRgNGLINC80LXRgtC60LguXHJcbiAgICAgICAgICAgICAgICBpY29uSW1hZ2VTaXplOiBbMjI2LCAzMF0sXHJcbiAgICAgICAgICAgICAgICAvLyDQodC80LXRidC10L3QuNC1INC70LXQstC+0LPQviDQstC10YDRhdC90LXQs9C+INGD0LPQu9CwINC40LrQvtC90LrQuCDQvtGC0L3QvtGB0LjRgtC10LvRjNC90L5cclxuICAgICAgICAgICAgICAgIC8vINC10ZEgXCLQvdC+0LbQutC4XCIgKNGC0L7Rh9C60Lgg0L/RgNC40LLRj9C30LrQuCkuXHJcbiAgICAgICAgICAgICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMSwgLTFdXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgIFxyXG5cclxuICAgIG15TWFwLmdlb09iamVjdHNcclxuICAgICAgICAuYWRkKG15UGxhY2VtYXJrKVxyXG59KTtcclxuLy8g0LrQvtC90LXRhiDQutCw0YDRgtGLXHJcbiIsImNvbnN0IGdldE1vYk1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9iLW1lbnUnKTtcbmNvbnN0IGdldE9wZW5Nb2JNZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vYmlsZS1tZW51Jyk7XG5jb25zdCBnZXRVc2VyTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy51c2VyX19saW5rJyk7XG5cbmdldE1vYk1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjbG9zZU1vYk1lbnUpO1xuXG5mdW5jdGlvbiBjbG9zZU1vYk1lbnUoKSB7XG4gIGdldE1vYk1lbnUuY2xhc3NMaXN0LmFkZCgnbW9iLW1lbnUtaGlkZScpXG59O1xuXG5nZXRPcGVuTW9iTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Nb2JNZW51KTtcblxuZnVuY3Rpb24gb3Blbk1vYk1lbnUoKSB7XG4gIGdldE1vYk1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnbW9iLW1lbnUtaGlkZScpXG59O1xuXG5cbiIsInZhciBsaW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi51c2VyX19saW5rXCIpO1xyXG5cclxudmFyIHBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1sb2dpblwiKTtcclxudmFyIGNsb3NlID0gcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbC1jbG9zZVwiKTtcclxuXHJcbnZhciBmb3JtID0gcG9wdXAucXVlcnlTZWxlY3RvcihcImZvcm1cIik7XHJcbnZhciBsb2dpbiA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCJbbmFtZT1sb2dpbl1cIik7XHJcbnZhciBwYXNzd29yZCA9IHBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCJbbmFtZT1wYXNzd29yZF1cIik7XHJcblxyXG52YXIgc3RvcmFnZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwibG9naW5cIik7XHJcblxyXG5saW5rWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbkNsaWNrKTtcclxubGlua1sxXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb25DbGljayk7XHJcblxyXG5mdW5jdGlvbiBmdW5jdGlvbkNsaWNrIChldnQpIHtcclxuXHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LmFkZChcIm1vZGFsLXNob3dcIik7XHJcblxyXG4gIGlmIChzdG9yYWdlKSB7XHJcbiAgICBsb2dpbi52YWx1ZSA9IHN0b3JhZ2U7XHJcbiAgICBwYXNzd29yZC5mb2N1cygpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBsb2dpbi5mb2N1cygpO1xyXG4gIH1cclxufTtcclxuXHJcbmNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLXNob3dcIik7XHJcbiAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLWVycm9yXCIpO1xyXG59KTtcclxuXHJcbmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgaWYgKCFsb2dpbi52YWx1ZSB8fCAhcGFzc3dvcmQudmFsdWUpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLWVycm9yXCIpO1xyXG4gICAgcG9wdXAub2Zmc2V0V2lkdGggPSBwb3B1cC5vZmZzZXRXaWR0aDtcclxuICAgIHBvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbC1lcnJvclwiKTtcclxuICB9IGVsc2Uge1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJsb2dpblwiLCBsb2dpbi52YWx1ZSk7XHJcbiAgfVxyXG4gIGNvbnNvbGUubG9nKGxvZ2luLnZhbHVlLCBwYXNzd29yZC52YWx1ZSk7XHJcblxyXG4gIGNvbnN0IHN1Y2Nlc3NPdmVybGF5MyA9IGNyZWF0ZU92ZXJsYXkoYNCS0L7RgiDRgtGD0YIg0LLQsNGI0Lgg0LTQsNC90L3Ri9C1ICgke2xvZ2luLnZhbHVlfToke3Bhc3N3b3JkLnZhbHVlfSkg0LHRg9C00YPRgiDQutGD0LTQsC3RgtC+INC+0YLQv9GA0LDQstC70LXQvdGLYCk7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzdWNjZXNzT3ZlcmxheTMpO1xyXG4gIFxyXG59KTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXlDb2RlID09PSAyNykge1xyXG4gICAgaWYgKHBvcHVwLmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsLXNob3dcIikpIHtcclxuICAgICAgcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsLXNob3dcIik7XHJcbiAgICAgIHBvcHVwLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbC1lcnJvclwiKTtcclxuICAgIH1cclxuICB9XHJcbn0pO1xyXG5cclxuIiwiY29uc3QgZ2V0TmV3c1Nob3dCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3cy1zaG93Jyk7XHJcbmNvbnN0IGdldEhpZGVOZXdzTGlzdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmV3c19fbGlzdC0tYm90dG9tJyk7XHJcbi8vIGNvbnN0IGdldFNob3dOZXdzTGlzdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubmV3c19fbGlzdC0tc2hvdycpO1xyXG5cclxuZ2V0TmV3c1Nob3dCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jTmV3c1Nob3cpO1xyXG5cclxuZnVuY3Rpb24gZnVuY05ld3NTaG93KCkge1xyXG4gICAgZ2V0SGlkZU5ld3NMaXN0cy5mb3JFYWNoKGVsZW0gPT4ge1xyXG4gICAgICAgIGVsZW0uY2xhc3NMaXN0LnRvZ2dsZSgnbmV3c19fbGlzdC0tc2hvdycpXHJcbiAgICB9KTtcclxuICAgIGdldE5ld3NTaG93QnRuLmlubmVySFRNTCA9ICfRgdC/0YDRj9GC0LDRgtGMJztcclxuICAgIGdldE5ld3NTaG93QnRuLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY05ld3NTaG93KTtcclxuICAgIGdldE5ld3NTaG93QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY05ld3NIaWRlKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGZ1bmNOZXdzSGlkZSgpIHtcclxuICAgXHJcbiAgICBnZXRIaWRlTmV3c0xpc3RzLmZvckVhY2goZWxlbSA9PiB7XHJcbiAgICAgICAgZWxlbS5jbGFzc0xpc3QudG9nZ2xlKCduZXdzX19saXN0LS1zaG93JylcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBnZXROZXdzU2hvd0J0bi5pbm5lckhUTUwgPSAn0L/QvtC60LDQt9Cw0YLRjCDQstGB0LUnO1xyXG4gICAgZ2V0TmV3c1Nob3dCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jTmV3c0hpZGUpO1xyXG4gICAgZ2V0TmV3c1Nob3dCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jTmV3c1Nob3cpO1xyXG59O1xyXG5cclxuLy8g0L3QsNGH0LDQu9C+INC60L7QtNCwINC80L7QtNCw0LvRjNC90L7QtSDQvtC60L3QviDQvtGC0LfRi9Cy0L7QslxyXG5sZXQgdGV4dCA9ICc8YnI+PGJyPjxzdHJvbmc+0KHQldCa0KDQldCi0Ksg0JzQr9CT0JrQntCZINCYINCf0J7QodCb0KPQqNCd0J7QmSDQkdCe0KDQntCU0Ks8L3N0cm9uZz4gXFxcclxuPGJyPjxicj4xLiDQk9Ce0KDQr9Cn0JjQmSDQlNCj0KguINCf0J7QktCr0KjQldCd0J3QkNCvINCS0JvQkNCW0J3QntCh0KLQrCDQmCDQn9CQ0KAsINCg0JDQodCf0JDQoNCv0KIg0JrQntCb0K7Qp9CY0JUg0JLQntCb0J7QodCa0Jgg0JLQkNCo0JXQmSDQkdCe0KDQntCU0KsuINCf0J7QodCb0JUg0JTQo9Co0JAsINCS0J7QodCf0J7Qm9Cs0JfQo9CZ0KLQldCh0Kwg0KPQktCb0JDQltCd0K/QrtCp0JjQnCDQnNCQ0KHQm9Ce0JwgKNCb0K7QkdCr0JwsINCa0J7QotCe0KDQntCVINCjINCS0JDQoSDQldCh0KLQrCDQmNCb0Jgg0KHQn9CV0KbQmNCQ0JvQrNCd0KvQnCDQlNCb0K8g0JHQntCg0J7QlNCrKSwg0J3QkNCa0KDQntCZ0KLQlSDQm9CY0KbQniDQnNCQ0KXQoNCe0JLQq9CcINCf0J7Qm9Ce0KLQldCd0KbQldCcINCd0JAgMTAtMTUg0JzQmNCd0KPQoiDQmCDQodCU0JXQm9CQ0JnQotCVINCb0JXQk9Ca0JjQmSDQnNCQ0KHQodCQ0JYuXFxcclxuPGJyPjxicj4yLiDQndCVINCc0J7QmdCi0JUg0JHQntCg0J7QlNCjINCa0JDQltCU0KvQmSDQlNCV0J3QrCEhIdCe0KIg0JXQltCV0JTQndCV0JLQndCe0JPQniDQnNCr0KLQrNCvLNCS0J7Qm9Ce0KHQqyDQndCQINCR0J7QoNCe0JTQlSDQodCi0JDQndCe0JLQr9Ci0KHQryDQldCp0JUg0JbQldCh0KLQp9CVLiDQnNCe0JbQndCeINCc0KvQotCsINCn0JXQoNCV0Jcg0JTQldCd0Kws0JXQodCb0Jgg0K3QotCeINCa0KDQkNCZ0J3QlSDQndCV0J7QkdCl0J7QlNCY0JzQniwg0KLQntCT0JTQkCDQn9Cg0JjQoNCe0JTQndCr0JUg0JzQkNCh0JvQkCzQmtCe0KLQntCg0KvQlSDQlNCV0JvQkNCu0KIg0JLQntCb0J7QodCrINCf0J7QodCb0KPQqNCd0KvQnNCYINCj0KHQn9CV0K7QoiDQndCQ0JrQntCf0JjQotCs0KHQry5cXFxyXG48YnI+PGJyPjMuINCa0J7QndCU0JjQptCY0J7QndCV0KAg0JTQm9CvINCS0J7Qm9Ce0KEg0JjQm9CYINCh0J/QldCm0JjQkNCb0KzQndCr0Jkg0JrQntCd0JTQmNCm0JjQntCd0JXQoCDQlNCb0K8g0JHQntCg0J7QlNCrLiDQlNCQ0J3QndCe0JUg0KHQoNCV0JTQodCi0JLQniDQn9Ce0JzQntCW0JXQoiDQo9Cf0KDQkNCS0JvQr9Ci0Kwg0JLQntCb0J7QodCQ0JzQmCDQmCDQodCU0JXQm9CQ0KLQrCDQmNClINCc0JDQmtCh0JjQnNCQ0JvQrNCd0J4g0J/QntCU0JDQotCb0JjQktCr0JzQmC4nO1xyXG5cclxuY29uc3QgZ2V0Q29tbWVudHNTZWxlY3RvcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm5ld3NfX21vcmUtbGlua1wiKTtcclxuY29uc3Qgc3VjY2Vzc092ZXJsYXkgPSBjcmVhdGVPdmVybGF5KFwiIDxpbWcgc3JjPVxcXCIuL2ltZy9uZXdzL25ld3MxLmpwZ1xcXCI+XCIgKyB0ZXh0KTtcclxuLy8gY29uc29sZS5sb2coZ2V0Q29tbWVudHNTZWxlY3RvcnMubGVuZ3RoKTtcclxuXHJcblxyXG5mb3IgKGxldCBpID0gMDsgaSA8IGdldENvbW1lbnRzU2VsZWN0b3JzLmxlbmd0aDsgaSArPSAxKSB7XHJcbiAgICBnZXRDb21tZW50c1NlbGVjdG9yc1tpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHN1Y2Nlc3NPdmVybGF5KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVPdmVybGF5KGNvbnRlbnQpIHtcclxuICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJvdmVybGF5XCIpO1xyXG4gIFxyXG4gICAgY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI292ZXJsYXlUZW1wbGF0ZVwiKTtcclxuICAgIG92ZXJsYXlFbGVtZW50LmlubmVySFRNTCA9IHRlbXBsYXRlLmlubmVySFRNTDtcclxuICBcclxuICAgIGNvbnN0IGNsb3NlRWxlbWVudCA9IG92ZXJsYXlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2xvc2VcIik7XHJcbiAgICBjbG9zZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICBcclxuICAgIGNvbnN0IGNvbnRlbnRFbGVtZW50ID0gb3ZlcmxheUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpO1xyXG4gICAgY29udGVudEVsZW1lbnQuaW5uZXJIVE1MID0gY29udGVudDtcclxuICBcclxuICAgIHJldHVybiBvdmVybGF5RWxlbWVudDtcclxuICB9XHJcblxyXG4iLCJjb25zdCBnZXRTbGlkZXJCdG5TdWJtaXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLS1zdWJtaXQnKTtcclxuY29uc3QgZ2V0U2xpZGVyU3VibWl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXItZm9ybScpO1xyXG5jb25zdCBnZXRTbGlkZXJTdWJtaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVyLWZvcm1fX3N1Ym1pdCcpO1xyXG5jb25zdCBnZXRTbGlkZXJQID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNsaWRlci1mb3JtX19vdXQnKTtcclxuXHJcbmdldFNsaWRlckJ0blN1Ym1pdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNyZWF0ZVN1Ym1pdEZvcm0pO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlU3VibWl0Rm9ybSgpIHtcclxuICAgIGdldFNsaWRlclN1Ym1pdEZvcm0uc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xyXG4gICAgZ2V0U2xpZGVyU3VibWl0Rm9ybS5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG59O1xyXG5cclxuZ2V0U2xpZGVyU3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY3JlYXRlTmV3Q29tbWVudCk7XHJcblxyXG4iLCJjb25zdCBsZWZ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX2xlZnRcIik7XHJcbmNvbnN0IHJpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXJfX3JpZ2h0XCIpO1xyXG5jb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaXRlbXNcIik7XHJcbmNvbnN0IHNsaWRlckRvdHNBbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xpZGVyX19kb3RzLWl0ZW0nKTtcclxuY29uc3Qgc2xpZGVyRG90c0RpdiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX2RvdHMnKTtcclxuY29uc3QgaXRlbSA9IGl0ZW1zLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZWxlbVwiKTtcclxuXHJcbmNvbnN0IHdpZHRoID0gMTAwO1xyXG5sZXQgY291bnQgPSAwO1xyXG5cclxucmlnaHQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICBpZiAoY291bnQgPD0gaXRlbS5sZW5ndGggLSAyKSB7XHJcbiAgICAgICAgY291bnQgKz0gMTtcclxuXHJcbiAgICAgICAgbWFrZVBvc2l0aW9uKGNvdW50KTtcclxuXHJcbiAgICAgICAgc2xpZGVyRG90c0FsbC5mb3JFYWNoKGVsZW0gPT4gZWxlbS5jbGFzc0xpc3QucmVtb3ZlKCdzbGlkZXJfX2RvdHMtaXRlbS0tYWN0aXZlJykpO1xyXG4gICAgICAgIHNsaWRlckRvdHNBbGxbY291bnRdLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9fZG90cy1pdGVtLS1hY3RpdmUnKTtcclxuICAgIH1cclxufSk7XHJcblxyXG5sZWZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgIGlmIChjb3VudCAhPT0gMCkge1xyXG4gICAgICAgIGNvdW50IC09IDE7XHJcblxyXG4gICAgICAgIG1ha2VQb3NpdGlvbihjb3VudCk7XHJcblxyXG4gICAgICAgIHNsaWRlckRvdHNBbGwuZm9yRWFjaChlbGVtID0+IGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnc2xpZGVyX19kb3RzLWl0ZW0tLWFjdGl2ZScpKTtcclxuICAgICAgICBzbGlkZXJEb3RzQWxsW2NvdW50XS5jbGFzc0xpc3QuYWRkKCdzbGlkZXJfX2RvdHMtaXRlbS0tYWN0aXZlJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5cclxuc2xpZGVyRG90c0Rpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNoYW5nZUFjdGl2ZURvdHMpO1xyXG5cclxuZnVuY3Rpb24gY2hhbmdlQWN0aXZlRG90cyhldmVudCkge1xyXG5cclxuICAgIHNsaWRlckRvdHNBbGwuZm9yRWFjaChlbGVtID0+IGVsZW0uY2xhc3NMaXN0LnJlbW92ZSgnc2xpZGVyX19kb3RzLWl0ZW0tLWFjdGl2ZScpKTtcclxuICAgIFxyXG5cclxuXHJcbiAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmFkZCgnc2xpZGVyX19kb3RzLWl0ZW0tLWFjdGl2ZScpO1xyXG5cclxuICAgIHNsaWRlckRvdHNBbGwuZm9yRWFjaCgoZWxlbSwgbnVtKSA9PiB7XHJcbiAgICAgICAgaWYoZWxlbS5jbGFzc0xpc3QuY29udGFpbnMoJ3NsaWRlcl9fZG90cy1pdGVtLS1hY3RpdmUnKSlcclxuICAgICAgICBtYWtlUG9zaXRpb24obnVtKTtcclxuICAgIH0gKTtcclxuXHJcbn07XHJcblxyXG5mdW5jdGlvbiBtYWtlUG9zaXRpb24oYXJnQ291bnQpIHtcclxuICAgIHBvc2l0aW9uID0gd2lkdGggKiBhcmdDb3VudDtcclxuICAgIHJldHVybiBpdGVtcy5zdHlsZS5tYXJnaW5MZWZ0ID0gJy0nICsgcG9zaXRpb24gKyAnJSc7XHJcbn07IiwiXHJcbmxldCBwbGF5ZXI7XHJcblxyXG5mdW5jdGlvbiBvbllvdVR1YmVJZnJhbWVBUElSZWFkeSgpIHtcclxuICAgIHBsYXllciA9IG5ldyBZVC5QbGF5ZXIoJ3BsYXllcicsIHtcclxuICAgICAgICAvLyBoZWlnaHQ6ICczNjAnLFxyXG4gICAgICAgIC8vIHdpZHRoOiAnNjQwJyxcclxuICAgICAgICB2aWRlb0lkOiAnMmUwbkVnTEFybzQnLFxyXG4gICAgICAgIHBsYXllclZhcnM6IHtcclxuICAgICAgICAgICAgZW5hYmxlanNhcGk6IDEsXHJcbiAgICAgICAgICAgIGNvbnRyb2xzOiAwLFxyXG4gICAgICAgICAgICBkaXNhYmxla2I6IDAsXHJcbiAgICAgICAgICAgIHNob3dpbmZvOiAwLFxyXG4gICAgICAgICAgICByZWw6IDAsXHJcbiAgICAgICAgICAgIGF1dG9wbGF5OiAwLFxyXG4gICAgICAgICAgICBtb2Rlc3RicmFuZGluZzogMVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXZlbnRzOiB7XHJcbiAgICAgICAgICAgIC8vICdvblJlYWR5Jzogb25QbGF5ZXJSZWFkeSxcclxuICAgICAgICAgICAgLy8gJ29uU3RhdGVDaGFuZ2UnOiBvblBsYXllclN0YXRlQ2hhbmdlXHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbmNvbnN0IGdldFZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXJfX3ZpZGVvXCIpO1xyXG5jb25zdCBnZXRWaWRlb1BsYXlQYXVzZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudmlkZW9fX3BsYXktcGF1c2VcIik7XHJcbmNvbnN0IGdldGNWaWRlb0ljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRyb2xfX3ZpZGVvLWljb25cIik7XHJcbmNvbnN0IGdldFRpbWVSYW5nZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udHJvbF9fdGltZS1yYW5nZVwiKTtcclxuY29uc3QgZ2V0QXVkaW9QbGF5UGF1c2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRyb2xfX3NvdW5kLWljb25cIik7XHJcbmNvbnN0IGdldFNvdW5kUmFuZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRyb2xfX3NvdW5kLXJhbmdlXCIpO1xyXG5cclxuXHJcbmdldFZpZGVvUGxheVBhdXNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheVBhdXNlKTtcclxuZ2V0Y1ZpZGVvSWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlQYXVzZSk7XHJcbmdldFZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCBwZXJjZW50UmFuZ2UpO1xyXG5nZXRUaW1lUmFuZ2UuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBwcm9ncmVzc1JhbmdlKTtcclxuXHJcbmdldEF1ZGlvUGxheVBhdXNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcGxheUF1ZGlvKTtcclxuZ2V0U291bmRSYW5nZS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIHBlcmNlbnRTb3VuZCk7XHJcbmZ1bmN0aW9uIGdldEN1cnJlbnRUaW1lKCkge1xyXG4gICAgdmFyIGN1cnJlbnRUaW1lID0gcGxheWVyLmdldEN1cnJlbnRUaW1lKCk7XHJcbiAgICByZXR1cm4gcm91bmROdW1iZXIoY3VycmVudFRpbWUsIDMpO1xyXG4gIH1cclxuY29uc29sZS5sb2cocGxheWVyLmdldFBsYXllclN0YXRlKCkpO1xyXG5cclxuZnVuY3Rpb24gcGxheVBhdXNlKCkge1xyXG5cclxuICAgIGlmIChwbGF5ZXIuZ2V0UGxheWVyU3RhdGUoKSAhPT0gMSkge1xyXG4gICAgICAgIHBsYXllci5wbGF5VmlkZW8oKTtcclxuICAgICAgICBnZXRWaWRlb1BsYXlQYXVzZUJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwbGF5ZXIucGF1c2VWaWRlbygpO1xyXG4gICAgICAgIGdldFZpZGVvUGxheVBhdXNlQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMC41JztcclxuICAgIH1cclxufTtcclxuXHJcblxyXG5cclxuIl19
